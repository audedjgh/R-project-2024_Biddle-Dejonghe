---
title: "What socioeconomic factors drive investments in renewable energy in Europe ?"
author: "Aude Dejonghe and Carlos Biddle"
format: 
  html: default
  pdf: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```



```{r}
#| message: false
library(here)
here::i_am("R-project-2024_Biddle-Dejonghe.Rproj")
```

# INTRODUCTION

This document will show:

-   The sources used for the project with their description
-   The description of the work of joining and cleaning the data
-   The explanation of our research question
-   Data analysis from different points of view, with data-crossing
-   Conclusion to our research project

To begin with, click [here](https://github.com/audedjgh/R-project-2024_Biddle-Dejonghe) to access our github project.

```{r}
#| message: false
#| warning: false

# Load required libraries
library(readr)
library(readxl)
library(dplyr)
library(stringr)

# Define NA values
na_values <- c("NA", "NO", "IE", "NO,NA", "NO, NA", "NO,NE", "", "N/A")

# Creating the list of EU countries to filter data
EU_countries <- c("Austria", "Belgium", "Bulgaria", "Croatia", "Cyprus", "Czechia", "Denmark", "Estonia", "Finland", "France", "Germany", "Greece", "Hungary", "Ireland", "Italy", "Latvia", "Lithuania", "Luxembourg", "Malta", "Netherlands", "Poland", "Portugal", "Romania", "Slovakia", "Slovenia", "Spain", "Sweden"
)

# Clean numeric function
clean_numeric <- function(x) {
  if(is.character(x)) {
    x <- gsub(",", ".", x)
    x <- gsub(" ", "", x)
    suppressWarnings(as.numeric(x))
  } else {
    x
  }
}

# Simplified clean_dataset function
clean_dataset <- function(df) {
  id_columns <- c("LOCATION", "INDICATOR", "Indicator", "Inequality", "Unit Code", "Unit", "Country", "country", "COUNTRY", "Year", "year", "YEAR", "Country Name", "Country Code", "Indicator Name", "Indicator Code", "Country name", "Description as in CRF", "Sector_name", "Unit", "Emissions")
  
  df |>
    mutate(across(
      where(is.character) & !any_of(id_columns),
      ~clean_numeric(.)
    ))
}

# Import and clean datasets
suppressMessages({
  Better_Life_Index_2022 <- read_delim(
    file = "data/Clean 2022 Better Life Index.csv", 
    delim = ",", 
    escape_double = FALSE, 
    trim_ws = TRUE,
    na = na_values,
    show_col_types = FALSE
  ) %>% clean_dataset()
  
  Better_Life_Index_2013 <- read_delim(
    file = "data/Better Life Index 2013.csv", 
    delim = ";", 
    escape_double = FALSE, 
    trim_ws = TRUE,
    na = na_values,
    show_col_types = FALSE
  ) %>% clean_dataset()
  
  Education <- read_excel(
    path = "data/Education.xls", 
    sheet = "Data",
    na = na_values
  ) %>% clean_dataset()
  
  GDP <- read_excel(
    path = "data/GDP (current US$).xls", 
    sheet = "Data",
    na = na_values
  ) %>% clean_dataset()
  
  Gas_emissions <- read_excel(
    path = "data/GovReg_GHG proxy_2023.xlsx", 
    sheet = "EEA proxy dataset (plus)",
    na = na_values
  ) %>% clean_dataset()
  
  Health <- read_excel(
    path = "data/Health.xls", 
    na = na_values
  ) %>% clean_dataset()
  
  Share_of_renewable_sources <- read_excel(
    path = "data/Share of energy from renewable sources.xlsx", 
    sheet = "SUMMARY",
    skip = 1,
    na = na_values
  ) %>% clean_dataset()
})


# Filter datasets on information wanted

Better_Life_Index_2022 <- Better_Life_Index_2022 |>
  select(Country, Indicator, Unit, Value) |>
  filter(Country %in% EU_countries)

Better_Life_Index_2013 <- Better_Life_Index_2013 |>
  select(Country, Indicator, Inequality, Value) |>
  filter(Country %in% EU_countries, Inequality == "Total")

Education <- Education |>
  select(`Country Name`, `Indicator Name`, matches("^20\\d{2}$")) |>
  filter(`Country Name` %in% EU_countries)

Gas_emissions <- Gas_emissions |>
  select(`Country name`, `Description as in CRF`, Sector_name, Unit, Emissions) |>
  filter(`Country name` %in% EU_countries, str_detect(`Sector_name`, "Total"))

GDP <- GDP |>
  select(`Country Name`, `Indicator Name`, matches("^20\\d{2}$")) |>
  filter(`Country Name` %in% EU_countries)

Health <- Health |>
  select(`Country Name`, `Indicator Name`, matches("^20\\d{2}$")) |>
  filter(`Country Name` %in% EU_countries)

Overall_share_of_renewable_sources <- Share_of_renewable_sources |>
  slice(1:38) |>
  select(2:21) |>
  filter(`Country Name` %in% EU_countries)

colnames(Overall_share_of_renewable_sources)[-1] <- substr(colnames(Overall_share_of_renewable_sources)[-1], 1, 4)
```

## Link to sources

-   [Better Life Index 2022](https://www.oecd-ilibrary.org/social-issues-migration-health/data/oecd-social-and-welfare-statistics/better-life-index-edition-2022_a4815531-en)
-   [Education](https://data.worldbank.org/topic/education)
-   [GDP](https://data.worldbank.org/indicator/NY.GDP.MKTP.CD?locations=EU)
-   [Gas emissions](https://www.eea.europa.eu/en/datahub/datahubitem-view/f6e68f73-b494-4f8c-8c73-8a153a53f64a)
-   [Health](https://data.worldbank.org/topic/health)
-   [Share of renewable energy](https://ec.europa.eu/eurostat/web/energy/database/additional-data#Short%20assessment%20of%20renewable%20energy%20sources%20(SHARES))


# RESEARCH QUESTION DEVELOPMENT

## Introduction

The transition to renewable energy is a critical goal for European countries in addressing climate change, energy security, and sustainable development. While technological advancements and policy frameworks play pivotal roles in shaping this transition, socioeconomic factors are equally influential in driving investments in renewable energy. This project has the goal to explore the connections between certain socioeconomic dimensions—such as GDP, health, education, welfare, and pollution—and the level of renewable energy investments across Europe. Additionally, it'll highlight areas for further exploration to understand and visualize these dynamics effectively.

## The Role of Socioeconomic Factors

Economic Development (GDP and Income Levels): Economic prosperity, often measured by GDP per capita, is one of the primary determinants of renewable energy investments. Countries with higher GDPs, such as Germany, France, and the Netherlands, tend to allocate more resources to infrastructure development and energy transition projects. Wealthier nations often have greater access to capital markets, which facilitates investments in expensive renewable technologies, such as offshore wind farms or advanced solar panels. In contrast, economically weaker nations may struggle to meet initial investment costs, despite benefiting from EU funding schemes.

Health and Pollution Awareness: Pollution levels and associated health impacts often galvanize public and political support for cleaner energy sources. Countries experiencing severe air quality challenges, like Poland or Hungary (due to reliance on coal), may face greater pressure from citizens and advocacy groups to invest in renewables. The health burden from pollution, measured through indicators such as respiratory disease prevalence or life expectancy, can serve as a compelling argument for redirecting investments toward cleaner energy options.

Education and Public Awareness: Education plays a critical role in shaping attitudes toward environmental sustainability. Societies with higher literacy rates and widespread access to quality education are more likely to support renewable energy policies and initiatives. Public understanding of climate science, energy efficiency, and long-term benefits of renewable technologies can influence government and private-sector investment priorities. For instance, Scandinavian countries, known for their strong education systems, consistently lead in renewable energy adoption.

Social Welfare and Policy Support: Social welfare systems indirectly influence renewable energy investments. Countries with robust welfare systems, like Denmark or Sweden, can more easily absorb the social costs of transitioning from fossil fuels to renewables, such as retraining workers or subsidizing green energy access for low-income households. Additionally, higher levels of social trust and cooperative governance in these nations contribute to smoother implementation of renewable energy projects.

## Potential Areas for Further Exploration

Data Visualization: To understand these relationships better, a cross-country comparative analysis can be conducted using visual tools like scatterplots, heatmaps, or GIS maps. For instance, correlating GDP per capita with renewable energy capacity installed could reveal interesting patterns across Europe.

Temporal Trends: Analyzing how investments in renewables have evolved over the past decades relative to socioeconomic changes could uncover critical insights about long-term drivers.

Barriers in Low-GDP Nations: Examining the unique challenges faced by economically weaker European countries in scaling renewable investments, despite EU-wide climate goals, could highlight gaps in support mechanisms.




# DESCRIPTION OF THE DATASETS

## Better Life Index

Our first dataset includes data for the OECD's Better Life Index in 2022. The OECD Better Life Index Edition 2022 provides data on well-being across OECD member countries and some partners (we'll concentrate on 27 EU countries), covering topics such as housing, income, jobs, education, community, health, environment, safety, life satisfaction, and work-life balance. The data is compiled from national statistical offices, OECD surveys, and other relevant tools, ensuring global comparability of quality-of-life metrics. This dataset is updated annually, though some components, like subjective well-being or community engagement metrics, depend on periodic survey collections. It enables cross-country comparisons and offers insights into policy impacts on citizens' lives. Since our research is going to compare data over years, this is an example of the better life index, but we'll download and summarise other files like this to have an overview time wise. The data is available since 2013, each year.

|                        |                                  |
|------------------------|----------------------------------|
| Number of observations | `r NROW(Better_Life_Index_2022)` |
| Number of variables    | `r NCOL(Better_Life_Index_2022)` |

## Education

The education dataset from the World Bank database has 165 indicators to choose from, including enrollment rates, literacy levels, teacher-pupil ratios, government spending on education, and learning outcomes. This data is drawn from government ministries, international organizations, and World Bank studies. It is updated annually, though some indicators, like results from international assessments (e.g., PISA, TIMSS), are released every few years. The dataset supports monitoring of global education progress, disparities, and achievements, particularly in relation to Sustainable Development Goal 4 on quality education. We'll consider all 27 EU countries - into 4 income groups (high income, upper middle income, lower middle income, low income).

|                        |                     |
|------------------------|---------------------|
| Number of observations | `r NROW(Education)` |
| Number of variables    | `r NCOL(Education)` |

## GDP

This dataset provides annual Gross Domestic Product (GDP) figures in current US dollars for countries worldwide, with detailed data on the European Union. The World Bank collects this information from national accounts, statistical agencies, and IMF sources, ensuring consistency across countries. Updates occur annually, with quarterly estimates provided for certain regions. This dataset is vital for evaluating economic performance, identifying growth trends, and comparing the GDP of different regions and countries over time. It's calculated with official exchange rates, without adjusting for inflation or purchasing power parity, and represents the monetary value of all finished goods and services produced in an economy.

|                        |               |
|------------------------|---------------|
| Number of observations | `r NROW(GDP)` |
| Number of variables    | `r NCOL(GDP)` |

## Gas emissions

The European Environment Agency (EEA) Renewable Energy Data tracks the use and contribution of renewable energy in Europe, including electricity, heating, and transport sectors. It estimates the share of renewables in gross final energy consumption and monitors progress toward EU renewable energy targets. This data is collected from national energy statistics and harmonized through Eurostat and other EU reporting mechanisms. It is updated annually, following the SHARES (Short Assessment of Renewable Energy Sources) methodology, ensuring alignment with EU directives. The dataset is a key resource for assessing the EU’s progress toward climate and energy goals. It offers estimates for total emissions along with industry-specific contributions, for instance, those relating to energy, transport, and agriculture. The data is crucial for policymakers, researchers and environmentalists to study progress in emission reductions. Since our research is going to compare data over years, we plan to do the same thing as for "Better Life Index" dataset and join several years data together.

|                        |                         |
|------------------------|-------------------------|
| Number of observations | `r NROW(Gas_emissions)` |
| Number of variables    | `r NCOL(Gas_emissions)` |

## Health

Then, we have the health dataset, supplied by the World Bank.It includes indicators such as life expectancy, healthcare expenditure, immunization rates, and disease prevalence. The data is sourced from national health agencies, WHO publications, and World Bank studies. It is updated annually, with some metrics dependent on periodic demographic and health surveys (e.g., DHS) or WHO global health reports. This dataset enables the analysis of health outcomes, resource allocation, and comparisons of health system performance across countries and regions.

|                        |                  |
|------------------------|------------------|
| Number of observations | `r NROW(Health)` |
| Number of variables    | `r NCOL(Health)` |

## Share of renewable energy

Finally, the Eurostat Renewable Energy Database (SHARES) focuses on tracking renewable energy trends in the EU, measuring energy production, installed capacity, and the proportion of renewables in the energy mix. It also evaluates progress toward national and EU-wide renewable energy goals. Data is collected from national statistical offices and harmonized through EU legislative frameworks. Updates are conducted annually, using the SHARES methodology, which ensures consistent reporting and alignment with EU policies. This dataset provides detailed insights for policymakers and stakeholders engaged in the EU Green Deal and sustainable energy initiatives. It provides in-depth statistics on the fraction of renewable energy sources to gross final energy consumption in EU member states. The data covers electricity, heating and cooling, and transport. Key points include national shares of renewable energy, normalised values for hydropower and wind power, and compliance with sustainability criteria.

|                        |                                      |
|------------------------|--------------------------------------|
| Number of observations | `r NROW(Share_of_renewable_sources)` |
| Number of variables    | `r NCOL(Share_of_renewable_sources)` |

# MOST IMPORTANT VARIABLES

## Better Life Index

With the Better Life Index, the value associated to each country is calculated as a weighted score of 11 topics. The dataset includes variables such as housing conditions, measured by the number of rooms per person and housing affordability, and income, represented by disposable household income and wealth per capita. It also tracks job-related metrics, like employment rates and job security, alongside education levels, community engagement, self-reported health status, air quality indicators for the environment, and crime rates for safety. Additional variables include life satisfaction and work-life balance, focusing on time spent between work and leisure.

## Education

As for the education dataset, we can focus on the variable "Educational attainment, at least completed upper secondary, population 25+, total (%) (cumulative)", as it measures the proportion of the adult population with at least a high school diploma, which is a crucial indicator of human capital development, and helps understand a country's workforce competitiveness. The dataset encompasses variables like gross and net enrollment rates at different education levels, literacy rates by age group, and teacher-pupil ratios. It also includes government education expenditure as a percentage of GDP and learning outcomes, represented by scores from international assessments such as PISA and TIMSS.

## GDP

The dataset provides annual GDP figures in current USD for countries worldwide, along with growth rates that reflect year-on-year economic performance. It also breaks down sectoral contributions to GDP, such as agriculture, industry, and services, and facilitates regional comparisons of economic output across countries.

## Gas emissions

Key variables include the share of renewable energy in gross final energy consumption, the contribution of specific energy sources such as wind, solar, hydro, biomass, and geothermal, and the sectoral usage of renewables in electricity, heating, and transport. The dataset also monitors progress toward EU renewable energy targets.

## Health

The dataset includes variables like life expectancy at birth, healthcare expenditure (total and per capita), and immunization rates for diseases like measles and polio. It tracks the prevalence of diseases, including communicable and non-communicable conditions, as well as health resources, such as the number of doctors, nurses, and hospital beds per capita.

## Share of renewable energy

This dataset tracks annual renewable energy production in GWh or TWh, the installed capacity of renewable energy plants in MW, and the proportion of renewables in the total energy mix. It also includes progress indicators to assess alignment with national and EU-wide renewable energy targets.




# DATA ANALYSIS

In this document, we'll try to see and assess any links between certain socioeconomic factors of EU countries and their willingness to invest in renewable energy.

We can start by stating our intuition hypothesis : Countries with higher life satisfaction, better education, and lower air pollution levels are more likely to invest in renewable energy.


## Situation on life disparities between EU countries

### Visualization Air pollution's evolution (Better Life Index)

The graphs illustrate the levels of air pollution across various countries in 2013 and 2022, providing a comparative perspective on the evolution of air quality over time. Countries are ranked in descending order of air pollution levels for each year, highlighting both the most and least polluted nations within the dataset. 

```{r}
library(ggplot2)
library(dplyr)

Better_Life_Index_2013 |>
  filter(Indicator == "Air pollution") |>
  ggplot(aes(x = reorder(Country, Value), y = Value, fill = Value)) + 
  geom_bar(stat = "identity") +  
  coord_flip() + 
  labs(title = "Air pollution by Country (2013)", 
       x = "Country", 
       y = "Air pollution Value") +
  theme_minimal() +
  scale_fill_gradient(low = "lightblue", high = "darkblue") # Gradient color scale

Better_Life_Index_2022 |>
  filter(Indicator == "Air pollution") |>
  ggplot(aes(x = reorder(Country, Value), y = Value, fill = Value)) + 
  geom_bar(stat = "identity") +  
  coord_flip() + 
  labs(title = "Air pollution by Country (2022)", 
       x = "Country", 
       y = "Air pollution Value") +
  theme_minimal() +
  scale_fill_gradient(low = "lightgreen", high = "darkgreen") # Gradient color scale

```

There is a clear reduction in air pollution values across most countries between 2013 and 2022, indicating progress in environmental management and pollution control measures.
Despite overall improvements, Poland remains the most polluted country, reflecting persistent challenges in reducing air pollution.
Countries like Sweden, Estonia, and Finland consistently maintain low pollution levels, showcasing effective environmental policies and favorable conditions.

These graphs highlight the progress made in reducing air pollution across many countries over the decade. However, they also underline the need for sustained efforts in countries like Poland and Hungary, where air pollution remains a significant concern. Understanding the policies and factors contributing to success in low-pollution countries can provide valuable insights for addressing persistent environmental challenges.


### Visuaization of Life satisfaction's evolution (Better Life Index)

Our analysis begins with a chart representing the average score of life satisfaction each country obtained in 2013 and in 2022.

```{r}

Better_Life_Index_2013 |>
  filter(Indicator == "Life satisfaction") |>
  ggplot(aes(x = reorder(Country, Value), y = Value, fill = Value)) + 
  geom_bar(stat = "identity") +  
  coord_flip() + 
  labs(title = "Life Satisfaction by Country (2013)", 
       x = "Country", 
       y = "Life Satisfaction Value") +
  theme_minimal() +
  scale_fill_gradient(low = "lightblue", high = "darkblue") # Gradient color scale

Better_Life_Index_2022 |>
  filter(Indicator == "Life satisfaction") |>
  ggplot(aes(x = reorder(Country, Value), y = Value, fill = Value)) + 
  geom_bar(stat = "identity") +  
  coord_flip() + 
  labs(title = "Life Satisfaction by Country (2022)", 
       x = "Country", 
       y = "Life Satisfaction Value") +
  theme_minimal() +
  scale_fill_gradient(low = "lightgreen", high = "darkgreen") # Gradient color scale

```
The overall "Life Satisfaction" values appear to have slightly increased for most countries from 2013 to 2022, with Finland emerging as a standout performer by 2022. While the relative rankings for some countries like Greece and Hungary remain low, the overall progress indicates that life satisfaction is improving globally, albeit at different rates across regions.

We can start by stating our hypothesis : Countries with higher life satisfaction, better education, and lower air pollution levels are more likely to invest in renewable energy.

Let's then find out if the top countries in Life satisfaction are the same ones that are top ranks when seeing their share or renewable energy.


### Visualization of the evolution of the Share of renewabe energy across countries

```{r}
library(tidyr)

# First, let's prepare the data 
# We'll convert it from wide format (years as columns) to long format
overall_renewable_share_long <- Overall_share_of_renewable_sources %>%
  pivot_longer(
    cols = -`Country Name`,  
    names_to = "Year",
    values_to = "Share"
  )

#Create comparable base in 2022 to see ranking
overall_renewable_share_long |>
  filter(Year == 2022) |>
  ggplot(aes(x = reorder(`Country Name`, Share), y = Share, fill = Share)) + 
  geom_bar(stat = "identity") +  
  coord_flip() + 
  labs(title = "Share of renewable energy by EU Country (2022)", 
       x = "Country", 
       y = "Share of renewable energy (in%)") +
  scale_fill_gradient(low = "#FFB84D", high = "#FF4500") +  # Set gradient colors
  theme_minimal()
```

```{r, fig.width=10, fig.height=8, dpi=300}
# Create the line plot
ggplot(overall_renewable_share_long, aes(x = Year, y = Share, color = `Country Name`, group = `Country Name`)) +
  geom_line(linewidth = 1) +  # Increased line width for better visibility
  geom_point(size = 1.8, alpha = 0.8) +  # Adjusted point size and transparency
  theme_minimal() +
  labs(
    title = "Share of Renewable Energy Sources Over Time in EU Countries",
    x = "Year",
    y = "Share of Renewable Energy (%)",
    color = "Country"
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold", margin = margin(b = 15)),  # Larger title and spacing
    axis.text.x = element_text(angle = 45, hjust = 1, size = 12),  # Rotate x-axis labels for readability
    axis.text.y = element_text(size = 12),  # Increase size of y-axis labels
    axis.title.x = element_text(size = 14, face = "bold"),  # Bold x-axis title
    axis.title.y = element_text(size = 14, face = "bold"),  # Bold y-axis title
    legend.position = "bottom",  # Move legend below plot
    legend.title = element_text(size = 12, face = "bold"),  # Bold legend title
    legend.text = element_text(size = 10),  # Adjust legend text size
    legend.key.width = unit(1.2, "cm"),  # Increase spacing between legend keys
    plot.margin = margin(20, 20, 20, 20)  # Add margins around the plot
  ) +
  guides(color = guide_legend(nrow = 6))  # Arrange legend in 3 rows for compactness
```


Thanks to these graphs, we can visualize the evolution of EU countries through time regarding their share of renewable energy among total energy from 2004 and 2022. In other words, it shows how much shares of renewable energy their investment in this matter allowed them to have. 
We can see that the shares are globally increasing for every EU country studied.
But, the main difference with the life satisfaction critera studied before is that the top country is Sweden, with a large difference if we compare it to the other countries. 
Then we find Finland and Denmark in top 5, which is coherent with the Life satisfaction criteria.
Some other countries like France Poland and Hungary, are more or less coherent with analysis made previously.

However correlation is not proven and a bit blurry, so we're going to deepen the analysis, enlarging the criterions to more measurable ones, as "Life satisfaction" is hard to measure and not 100% reliable data.



## Relationship between GDP and share of renewable energy

```{r}
#| message: false
#| warning: false


library(dplyr)
library(tidyr)
library(ggplot2)
library(scales)

# Filter GDP dataset for years 2004-2022
GDP_filtered <- GDP |>
  select("Country Name", "2004":"2022") |>
  pivot_longer(cols = starts_with("200"), 
               names_to = "Year", 
               values_to = "GDP_Value") |>
  mutate(Year = as.integer(Year))  # Ensure Year is numeric

# Reshape renewable sources dataset
renewable_long <- Overall_share_of_renewable_sources |>
  pivot_longer(cols = starts_with("200"),
               names_to = "Year",
               values_to = "Renewable_Share") |>
  mutate(Year = as.integer(Year))  # Ensure Year is numeric

# Merge the reshaped datasets on Country Name and Year
data_merged <- merge(GDP_filtered, renewable_long, by = c("Country Name", "Year"))

# Plot GDP vs Renewable Energy Share for the merged dataset
suppressWarnings({
  ggplot(data_merged, aes(x = GDP_Value, y = Renewable_Share)) +
    geom_point() +
    geom_smooth(method = "lm", se = TRUE, color = "blue") +  # Include confidence interval
    labs(
      title = "GDP vs. Share of Renewable Energy", 
      x = "GDP Value (in USD)", 
      y = "Share of Renewable Energy (%)"
    ) +
    scale_x_continuous(labels = label_number(scale = 1e-12, suffix = "T")) +  # GDP in trillions
    scale_y_continuous(labels = label_percent()) +  # Remove scale = 1 to display percentages correctly
    theme_minimal()
})
```
The scatter plot illustrates the correlation between GDP and the share of renewable energy for EU countries from 2004 to 2022. Most data points are grouped toward the lower end of the GDP bracket, which indicates most of these nations have relatively low GDP values. In this region, there is a wide variation in renewable energy shares, from close to zero to exceeding 40%.

As GDP grows, renewable energy share fluctuates less, with wealthier countries generally exhibiting lower shares. The trend line suggests a weak negative relationship: higher-GDP nations tend to depend less on renewable energy. Nevertheless, the heavy concentration of data at lower GDP levels and the limit presence of higher-GDP countries suggest that the trend is primarily driven by lower-GDP nations.



## Distribution of renewable energy share according to education level

```{r}
# Load necessary libraries
library(dplyr)
library(ggplot2)
library(tidyr)

# Step 1: Filter Education dataset (adjust for existing column names)
Education_filtered <- Education |>
  filter(`Indicator Name` == "Educational attainment, at least completed upper secondary, population 25+, total (%) (cumulative)") |>
  select(-starts_with("20"))  # Adjust this based on actual column names

# Step 2: Filter Renewable Energy dataset (years 2004-2022)
RenewableEnergy_filtered <- Overall_share_of_renewable_sources |>
  select(1, 2:20)  # Adjust based on the correct column indices for 'Country Name' and the years 2004-2022

# Step 3: Combine both datasets by 'Country' (or another key column)
combined_data <- Education_filtered |>
  left_join(RenewableEnergy_filtered, by = "Country Name")

# Step 4: Rename the year columns to avoid conflicts
combined_data <- combined_data |>
  rename_at(vars(starts_with("20")), ~ paste0("RenewableShare_", .))

# Step 5: Reshape data to long format for ggplot
long_data <- combined_data |>
  pivot_longer(cols = starts_with("RenewableShare_"), names_to = "Year", values_to = "RenewableShare")

# Step 6: Categorize education levels based on thresholds

# Extract the relevant columns for renewable energy data (2004-2022)
relevant_columns <- combined_data[, grep("RenewableShare_", names(combined_data))]

# Convert the data to numeric (ignoring non-numeric entries)
relevant_columns <- as.data.frame(lapply(relevant_columns, as.numeric))

# Calculate mean and standard deviation for each column
mean_values <- colMeans(relevant_columns, na.rm = TRUE)
sd_values <- apply(relevant_columns, 2, sd, na.rm = TRUE)

# Define thresholds for high, medium, and low categories based on mean and standard deviation
high_thresholds <- mean_values + sd_values
low_thresholds <- mean_values - sd_values

# Add a column for education level categories for each year from 2004 to 2022
combined_data <- combined_data |>
  mutate(across(starts_with("RenewableShare_"), ~ case_when(
    . >= high_thresholds[as.character(cur_column())] ~ "High",
    . < high_thresholds[as.character(cur_column())] & . >= low_thresholds[as.character(cur_column())] ~ "Medium",
    . < low_thresholds[as.character(cur_column())] ~ "Low",
    TRUE ~ NA_character_  # Assign NA if data does not fit into categories
  ), .names = "EducationLevel_{col}"))

# Step 6.1: Ensure data is correctly joined
# Extract the latest education level category (e.g., for 2022)
combined_data <- combined_data |>
  mutate(EducationLevel_2022 = get("EducationLevel_RenewableShare_2022", combined_data))

# Step 6.2: Handle NA values in RenewableShare for plotting
long_data <- long_data |>
  mutate(RenewableShare = ifelse(is.na(RenewableShare), 0, RenewableShare))

# Step 6.3: Verify if EducationLevel_2022 has valid data
long_data <- long_data |>
  left_join(combined_data |> select(`Country Name`, EducationLevel_2022), by = "Country Name")

# Step 7: Create the boxplot
# Ensure the EducationLevel_2022 column is a factor with levels sorted as High, Medium, Low
long_data$EducationLevel_2022 <- factor(long_data$EducationLevel_2022, levels = c("High", "Medium", "Low"))

# Create the boxplot with sorted levels
ggplot(long_data |> filter(!is.na(EducationLevel_2022)), aes(x = EducationLevel_2022, y = RenewableShare, fill = EducationLevel_2022)) +
  geom_boxplot(na.rm = TRUE) +
  labs(
    title = "Distribution of Renewable Energy Share by Education Level",
    x = "Education Level",
    y = "Renewable Energy Share (%)"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("High" = "green", "Medium" = "yellow", "Low" = "red"))

```
This box plot presents the relationship between education levels (categorised as High, Medium, and Low) and the share of renewable energy usage (%) across EU countries. As we can see, nations with a High education level tend to have a greater share of renewable energy usage than those with Medium or Low scores. The median proportion of renewable energy for High is considerably higher, around 40%, with a wider interquartile range, highlighting variability in renewable energy adoption among this group of countries.

In contrast, EU countries classed as Low exhibit the lowest renewable energy shares, with a median of roughly 10% and a small interquartile range, suggesting little variability. As for Medium nations, they fall in between, with a median around 20%, showing a trend where higher education is linked to greater renewable energy use. This suggests a positive relationship between educational attainment and adoption of renewable energy, likely due to increased awareness, technological access, and a greater emphasis on renewable energy policies within highly educated populations. This reinforces the significance of education as a key driver of sustainable energy practices worldwide.


## Relationship between Health expenditure and the share of renewable energy

One could also think that investing in renewable energy would be similar to investment in the taking care of people. Then, another indicator showing the investment in the taking care of people could be the Health expenditure of governments.
Intuition question : Is the countries' health expenditure is related to their share of renewable energy ?

```{r, fig.width=10, fig.height=8, dpi=300}
#| message: false
#| warning: false

# First, convert Health table into one filtered on Health expenditure pivoted in long
health_expenditure_long <- Health |>
  filter(`Indicator Name` == 	
"Current health expenditure per capita, PPP (current international $)")|>
  select(-`Indicator Name`) |>
  pivot_longer(
    cols = -`Country Name`, 
    names_to = "Year",
    values_to = "Health_Expenditure_Per_Capita"
  )

# Merging Health expenditure and share of renewable energy datasets
merged_Health_exp_Renewable <- overall_renewable_share_long %>%
  inner_join(health_expenditure_long, by = c("Country Name", "Year"))

# Scatter plot with regression line



suppressWarnings({
  ggplot(merged_Health_exp_Renewable, aes(x = Health_Expenditure_Per_Capita, y = Share, color = `Country Name`)) +
    geom_point(size = 3, alpha = 0.7) +
    geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed") +
    labs(
      title = "Relationship Between Health Expenditure and Renewable Energy Share",
      x = "Current Health Expenditure Per Capita (USD)",
      y = "Renewable Energy Share (%)",
      color = "Country"
    ) +
    theme_minimal() +
    theme(
      plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
      legend.position = "bottom"
    )
})
```

```{r}
# Calculate correlation
correlation_Health_Renewable <- cor(merged_Health_exp_Renewable$Health_Expenditure_Per_Capita, merged_Health_exp_Renewable$Share, use = "complete.obs")

# Print the correlation
print(paste("Correlation coefficient:", round(correlation_Health_Renewable, 2)))
```

The graph illustrates the relationship between health expenditure per capita and renewable energy share across various countries. The data does not indicate a clear linear correlation between the two variables, as the points are widely scattered. 
Most countries fall within the mid-range of health expenditure (approximately $2000–$5000 per capita), with renewable energy shares predominantly ranging between 10% and 30%. Some countries with lower health expenditure exhibit relatively high renewable energy shares, suggesting that factors other than health investment play a more significant role in renewable energy adoption. 
Conversely, countries with higher health expenditures often display renewable energy shares closer to 20%, indicating a lack of consistent trends at higher levels of health spending. 

The variability among countries with similar health expenditures further highlights the importance of other influences, such as policy decisions, geographic conditions, or economic priorities, in determining renewable energy adoption.

We can conclude on this topic that there is no appearing correlation between the health expenditure of a country and its share of renewable energy.


## Multiple linear regression model : Share of renewable energy, GDP and labor force

This multiple linear regression model evaluates the relationship between Share of Renewable Energy (Share) (dependent variable) and two independent variables: GDP and Labor Force. The coefficients and their statistical significance provide insights into the effects of these predictors on the renewable energy share.

```{r}

# Pivot the GDP table
GDP_long <- GDP |>
  select(-`Indicator Name`) |>
  pivot_longer(
    cols = -`Country Name`, 
    names_to = "Year",
    values_to = "GDP"
  )

# Create and pivot a labor force table
Labor_force_long <- Education |>
  filter(`Indicator Name` == "Labor force, total") |>
  select(-`Indicator Name`) |>
  pivot_longer(
    cols = -`Country Name`, 
    names_to = "Year",
    values_to = "Labor_force"
  )

# Merging GDP, renewable energy and labor force
multi_lin_model_merge <- overall_renewable_share_long |>
  inner_join(GDP_long, by = c("Country Name", "Year")) |>
  inner_join(Labor_force_long, by = c("Country Name", "Year"))

# Modelling the multiple linear regression
multiple_var_model <- lm(Share ~ GDP + Labor_force , data = multi_lin_model_merge)
summary(multiple_var_model)
```
The multiple linear regression model investigates the relationship between the share of renewable energy and two predictors: GDP and Labor Force. The analysis reveals that both variables are statistically significant. GDP has a very small positive effect on the share of renewable energy, with a coefficient of 4.879×10−144.879×10−14. This indicates that for every unit increase in GDP, the renewable energy share increases by a negligible amount. Similarly, Labor Force shows a small but negative effect on renewable energy share, with a coefficient of −5.933×10−9−5.933×10−9. This implies that for every unit increase in the size of the labor force, the share of renewable energy slightly decreases.

Despite the statistical significance of these predictors (GDP p=0.014p=0.014, Labor Force p=0.000364p=0.000364), their practical influence on renewable energy share is minimal due to the very small magnitude of their coefficients. Furthermore, the model explains only 4.45% of the variability in renewable energy share, as indicated by the low R-squared value. This suggests that the model fails to capture most of the factors driving renewable energy adoption. The adjusted R-squared of 4.06% confirms the limited explanatory power of the model, even after accounting for the number of predictors.

The residual standard error of 0.1173 indicates moderate deviation of the observed values from the predicted ones, but this value alone does not indicate a strong model fit. The overall F-statistic (p=1.388e−05p=1.388e−05) shows that the model is statistically significant as a whole, meaning that the predictors together explain a non-random portion of the variability in renewable energy share.

In conclusion, while the model demonstrates statistical significance, its explanatory power is weak, and GDP and Labor Force have limited practical influence on renewable energy share. This points to the likelihood that other variables—such as governmental policies, geographic factors, energy resources, or societal preferences—play a more critical role in shaping renewable energy adoption. Future research should incorporate additional relevant variables to improve the model's explanatory capability and provide deeper insights into the drivers of renewable energy adoption.


# CONCLUSION

With this research, based on solid evidences from institutional datasets, we had in aim to answer to the maximum the following questions :

- Which socioeconomic factors have the strongest influence on renewable energy investments?
- How do these factors vary by country and over time?
- What policies should governments adopt to drive renewable energy investment?

This research explored the influence of socioeconomic factors on renewable energy investments in Europe, analyzing datasets covering education, GDP, health, air pollution, and renewable energy shares. The findings reveal complex relationships between these factors, with some offering partial insights but lacking strong explanatory power.

The analysis shows that countries with higher education levels and better life satisfaction tend to exhibit higher shares of renewable energy. This aligns with the notion that education fosters awareness and support for renewable energy policies. However, the relationship between renewable energy and health expenditure, as well as GDP, was weak or unclear, suggesting that these factors alone cannot explain the variability in renewable energy adoption. The multiple linear regression model confirmed the limited influence of GDP and labor force size on renewable energy shares, with only 4.45% of the variability explained by these predictors.

Air pollution trends indicate progress in reducing pollution across Europe, but significant challenges remain in certain countries like Poland and Hungary. These findings emphasize the importance of effective environmental policies, geographic factors, and societal priorities in shaping renewable energy investment. The observed variations across countries and over time highlight that no single factor dominates renewable energy adoption, pointing to a need for a multidimensional approach in future research.

There also are limits to our research analysis. To begin with, we couldn't find consolidated datasets on information that could have been really interesting to analyze, such as : the Education level or the level of investment in renewable energy.
But mainly, what would have been important to consider for this research, is policies et economic decisions made by the countries studied. It could have oriented and explained better the research results.

In conclusion, while socioeconomic factors like education and life satisfaction show some correlation with renewable energy adoption, other critical drivers — such as governmental policies, geographic conditions, and public awareness—play a more significant role. To achieve sustainable energy goals, policymakers should design tailored interventions that address country-specific challenges and leverage socioeconomic strengths to accelerate the transition to renewable energy.
